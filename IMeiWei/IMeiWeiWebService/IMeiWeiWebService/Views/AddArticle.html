<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="../Css/Navigation.css" type="text/css">
    <link rel="stylesheet" href="../Css/SelectControl.css" type="text/css">
    <link rel="stylesheet" href="../Css/AddArticle.css" type="text/css">
</head>
<body>
    <div class="css_main">
        <div class="css_top">
            <div class="css_top_left">
                <span>美位生活 & meiwei life</span><br>
                <span>App 管理操作后台</span>
            </div>
            <div class="css_top_right">
                <span style="Float:right">欢迎！Lain</span><br>
                <span style="Float:right">2015.02.08 09:35 AM</span>
            </div>
        </div>
        <div class="css_body">
            <div class="css_navigation">
                <div class="css_navigationItem">
                    <ul>商 户 添 加</ul>
                    <li><span class="css_inActive">&#12288</span><a href="IDelicious.html">爱 美 味</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="EnjoyLife.html">乐 生 活</a></li>
                </div>
                <div class="css_navigationItem">
                    <ul><a href="BusinessInformation.html">商 户 信 息</a></ul>
                </div>
                <div class="css_navigationItem">
                    <ul>分 类 管 理</ul>
                    <li><span class="css_inActive">&#12288</span><a href="AppCategory.html">APP 类 目</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="SceneClassification.html">场 景 分 类</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="AreaClassificationOne.html">区 域 分 类</a></li>
                </div>
                <div class="css_navigationItem">
                    <ul><a href="UserInfo.html">用 户 信 息</a></ul>
                </div>
                <div class="css_navigationItem">
                    <ul>服 务 设 置</ul>
                    <li><span class="css_inActive">&#12288</span><a href="ServicesModification.html">服 务 修 改</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="CouponsGeneration.html">折 扣 券 生 成</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="CouponsStatus.html">折 扣 券 状 态</a></li>
                </div>
                <div class="css_navigationItem">
                    <ul>广 告 设 置</ul>
                    <li><span class="css_inActive">&#12288</span><a href="AdSetting.html">广 告 设 置</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="AddEvents.html">添 加 活 动</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="EventsList.html">活 动 列 表</a></li>
                    <li><span class="css_inActive">&#12288</span><a href="TransactionList.html">成 交 列 表</a></li>
                </div>
                <div class="css_navigationItem">
                    <ul>文 章 管 理</ul>
                    <li><span class="css_inActive">&#12288</span><a href="ArticleList.html">文 章 列 表</a></li>
                    <li><span class="css_active"> > </span><a class="css_active" href="AddArticle.html">添 加 文 章</a></li>
                </div>
                <div class="css_navigationItem">
                    <ul><a href="DataExport.html">数 据 管 理</a></ul>
                </div>
            </div>
            <div class="css_content">
                <div class="css_content_userTable">
                    <div class="css_content_userTable_title">
                        <div class="css_content_userTable_title_name">
                            <span>活动列表</span>
                        </div>
                    </div>

                    <div class="css_content_event_info">
                        <table>
                            <tbody>
                                <tr>
                                    <td>文章标题:</td>
                                    <td><input id="articleTitle" type="text" placeholder="最多输入20个中文字符" /></td>
                                </tr>
                                <tr>
                                    <td>文章链接</td>
                                    <td><input id="articleLink" type="text" style="" /></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="css_content_li">
                        <ul id="container">
                            <li>
                                <img class="css_ImageButton" id="pickfiles" src="../Img/Img_UpLoadButton.png" />
                                <div>
                                    <span>图片上传</span><img style="visibility:hidden" />
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="css_content_event_detail">
                        <table>
                            <tbody>
                                <tr>
                                    <td>发布时间:2015.03.01</td>
                                </tr>
                                <tr>
                                    <td><span>阅读数量:</span><span id="readNo">0</span></td>
                                </tr>
                                <tr>
                                    <td><span>分享数量:</span><span id="shareNo">0</span></td>
                                </tr>
                                <tr>
                                    <td style="border: none; padding-top: 20px;">
                                        <input id="js_add" class="css_button css_button_add" type="button" value="添加" />
                                        <input class="css_button css_button_reInput" type="button" value="重填" />
                                        <input class="css_button css_button_delete" type="button" value="删除" />
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>




                <br>
                <br>
                <br>
                <br>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="../JSLibrary/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="../JSLibrary/SelectControl.js"></script>
    <script type="text/javascript" src="../JSLibrary/plupload.full.min.js"></script>
    <script type="text/javascript" src="../JSLibrary/jquery.Jcrop.min.js"></script>
    <script type="text/javascript">
        var fileName = "";
        var articleId = guid();
        $(function () {

            SetUpLoad();
        })

        function SetUpLoad() {
            var jcrop_api;
            var uploadCount = 0;

            var uploader = new plupload.Uploader({
                runtimes: 'html5,flash,silverlight,html4',
                browse_button: 'pickfiles', // you can pass in id...
                container: document.getElementById('container'), // ... or DOM Element itself
                url: '../WebService1.asmx/CreateArticleImgs',
                flash_swf_url: '../js/Upload.aspx.swf',
                silverlight_xap_url: '../js/Moxie.xap',
                multipart_params: { 'articleId': ''},

                filters: {
                    max_file_size: '5mb',
                    mime_types: [
                        { title: "Image files", extensions: "jpg,gif,png" },
                        { title: "Zip files", extensions: "zip" }
                    ]
                },

                init: {
                    FilesAdded: function (up, file) {
                        uploader.settings.multipart_params.articleId = articleId;
                        up.start();
                    },

                    UploadProgress: function (up, file) {

                        $("#Progress").html("长传进度" + file.percent + "%");
                    },

                    Error: function (up, err) {
                        document.getElementById('console').innerHTML += "\nError #" + err.code + ": " + err.message;
                    },

                    FileUploaded: function (up, file, info) {

                        var picPath = "../Uploads/" + info.response;
                        fileName = info.response;
                        $('#container div span').remove();
                        $('#container div img').attr('src', picPath);
                        $('#container div img').attr('style', "width:140px;height:108px;visibility:visible");


                    },
                }
            });

            uploader.init();
        };

        $("#js_add").click(function () {
            var id = articleId;
            var articleTitle = $("#articleLink").val();
            var articleLink = $("#articleLink").val();
            var readNo = $("#readNo").text();
            var shareNo = $("#shareNo").text();

            if (articleTitle == "") {
                alert("Please input the title of article.");
                return;
            }

            $.ajax({
                type: "POST", //访问WebService使用Post方式请求
                contentType: "application/json;charset=utf-8", //WebService 会返回Json类型
                url: "../WebService1.asmx/CreateArticle", //调用WebService
                data: "{id:'" + id + "',articleTitle:'" + articleTitle + "',articleLink:'"
                    + articleLink + "',readNo:'" + readNo + "',shareNo:'" + shareNo + "'}", //Email参数
                dataType: 'json',

                error: function (x, e) {
                    alert("error");
                },
                success: function (response) { //回调函数，result，返回值
                    alert(response.d);
                }
            })

        });

        function guid() {
            return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
        }
        function s4() {
            return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
        };

    </script>
</body>
</html>